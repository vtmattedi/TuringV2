#include <Arduino.h>
#include <D:\Projects\PIO\Turing\lib\NewPing\src\NewPing.h>
/*C
  Ultrasonic Sensor HC-SR04 and Arduino Tutorial

  by Dejan Nedelkovski,
  www.HowToMechatronics.com

*/
bool digital_debounce = false;
#define TEST_BUTTON 0
// defines pins numbers
int trigPin = 26;
int echoPin = 27;
int lastState = 0;
// defines variables

NewPing sonar(trigPin, echoPin, 200); // NewPing setup of pins and maximum distance.

void setup() {
  Serial.begin(115200); // Open serial monitor at 115200 baud to see ping results.
}

void loop() {

  if (digitalRead(TEST_BUTTON) == LOW && digital_debounce)
  {
    int oldMillis = millis();        // Wait 50ms between pings (about 20 pings/sec). 29ms should be the shortest delay between pings.
    int dist = sonar.ping_median(3); // Send ping, get distance in cm and print result (0 = outside set distance range)
    int timespent = millis() - oldMillis;
    float result = (float)dist / US_ROUNDTRIP_CM;
    Serial.printf("dist: %.1f cm, time: %d ms\n", result, timespent);
    delay(1000);
  }

  if (digitalRead(TEST_BUTTON) == HIGH)
  {
    digital_debounce = true;
  }
}